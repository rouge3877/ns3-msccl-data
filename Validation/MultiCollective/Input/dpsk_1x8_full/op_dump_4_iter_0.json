[
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 1, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 8, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16, 2048, 1, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 12800]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 12800]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.all_reduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.all_reduce",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "forward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [],
    "kwargs": {},
    "mode": "forward"
  },
  {
    "signature": "backward[torch.nn.functional.nll_loss]",
    "source_node_signature": "torch.nn.functional.nll_loss",
    "args": [
      "tensor(shape=torch.Size([2048, 102400]), dtype=torch.float32)",
      "tensor(shape=torch.Size([2048]), dtype=torch.int64)"
    ],
    "kwargs": {
      "weight": "None",
      "size_average": "None",
      "ignore_index": "-100",
      "reduce": "None",
      "reduction": "sum"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.log_softmax]",
    "source_node_signature": "torch.nn.functional.log_softmax",
    "args": [
      "tensor(shape=torch.Size([2048, 102400]), dtype=torch.float32)"
    ],
    "kwargs": {
      "dim": "-1",
      "_stacklevel": "3",
      "dtype": "torch.float32"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([102400, 2048, 1]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([102400, 2048, 1]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([12800, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2816]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2816, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_moe_gmm]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_moe_gmm",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.int64)",
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)",
      "tensor(shape=torch.Size([1]), dtype=torch.float32)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1408, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 1408]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "n_routed_experts": "64",
      "local_expert_start": "32",
      "local_expert_end": "40"
    },
    "differentiable_args_indices": [
      0,
      2,
      3,
      4,
      5,
      6
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([1]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [
      "tensor(shape=torch.Size([16384, 6]), dtype=torch.float32)"
    ],
    "kwargs": {
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.identity_allreduce",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.moe_route]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.moe_route",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([64, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "topk_method": "greedy",
      "top_k": "6",
      "n_group": "1",
      "n_routed_experts": "64",
      "topk_group": "1",
      "training": "True",
      "alpha": "0.001",
      "norm_topk_prob": "False",
      "routed_scaling_factor": "1.0",
      "seq_aux": "True"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "4"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "1",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 10944]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 10944]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 256, 10944]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 256, 10944]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([10944, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.silu]",
    "source_node_signature": "torch.nn.functional.silu",
    "args": [
      "tensor(shape=torch.Size([8, 256, 10944]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "inplace": "False"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([10944, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 16, 192]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 128, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward]",
    "source_node_signature": "modeling.modeling_deepseek_modifier.nnscaler_flash_attention_forward",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dropout": "0.0",
      "causal": "True",
      "attention_mask": "None",
      "query_length": "2048"
    },
    "differentiable_args_indices": [
      0,
      1,
      2
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2048, 2, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 2, 8, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.pad]",
    "source_node_signature": "torch.nn.functional.pad",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "pad": [
        "0",
        "64"
      ],
      "mode": "constant",
      "value": "0.0"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 2, 2048, 128]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 128]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "3",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 1, 2048, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 1, 2048, 8]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.add]",
    "source_node_signature": "torch.add",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "alpha": "1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.cat]",
    "source_node_signature": "nnscaler.runtime.function.cat",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([8, 16, 256, 32]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(32, None, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.fullslice]",
    "source_node_signature": "nnscaler.runtime.function.fullslice",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, None, None)",
      "slice(None, 32, None)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.mul]",
    "source_node_signature": "torch.mul",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([1, 1, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 1, 2048, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 32, 2]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "4",
      "dim1": "3"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([1, 16, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "128"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([1, 2048, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_to_all_single",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048, 1, 16, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.alltoall_alltoall",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([4096, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([512]), dtype=torch.bfloat16)",
      [
        "512"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 512]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 1, 64]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "512",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allreduce_identity]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allreduce_identity",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 576]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([576, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[torch.functional.split]",
    "source_node_signature": "torch.functional.split",
    "args": [
      "tensor(shape=torch.Size([8, 16, 256, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "split_size_or_sections": [
        "128",
        "64"
      ],
      "dim": "-1"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.transpose]",
    "source_node_signature": "torch.transpose",
    "args": [
      "tensor(shape=torch.Size([8, 256, 16, 192]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim0": "1",
      "dim1": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[torch.nn.functional.linear]",
    "source_node_signature": "torch.nn.functional.linear",
    "args": [
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([3072, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "bias": "None"
    },
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_gather",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [
      [
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)",
        "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
      ],
      "tensor(shape=torch.Size([8, 256, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "group": "None",
      "async_op": "False"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "nnscaler.runtime.adapter.nn.split_allgather",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[apex.normalization.fused_layer_norm.fused_rms_norm_affine]",
    "source_node_signature": "apex.normalization.fused_layer_norm.fused_rms_norm_affine",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)",
      "tensor(shape=torch.Size([2048]), dtype=torch.bfloat16)",
      [
        "2048"
      ],
      "1e-06"
    ],
    "kwargs": {},
    "differentiable_args_indices": [
      0,
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.multiref]",
    "source_node_signature": "nnscaler.runtime.function.multiref",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 2048]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "times": "2"
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.adapter.nn.allgather_split]",
    "source_node_signature": "nnscaler.runtime.adapter.nn.allgather_split",
    "args": [
      "tensor(shape=torch.Size([8, 2048, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "dim": "2",
      "ranks": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7"
      ]
    },
    "differentiable_args_indices": [
      0
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "backward[nnscaler.runtime.function.embedding]",
    "source_node_signature": "nnscaler.runtime.function.embedding",
    "args": [
      "tensor(shape=torch.Size([8, 2048]), dtype=torch.int64)",
      "tensor(shape=torch.Size([102400, 256]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "padding_idx": "None",
      "start": "0",
      "stop": "102400"
    },
    "differentiable_args_indices": [
      1
    ],
    "differentiable_kwargs_keys": [],
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.all_reduce",
    "source_node_signature": "reducer",
    "args": [
      "tensor(shape=torch.Size([743585280]), dtype=torch.bfloat16)"
    ],
    "kwargs": {
      "op": "RedOpType.SUM",
      "group": "None"
    },
    "mode": "backward"
  },
  {
    "signature": "torch.distributed.get_world_size",
    "source_node_signature": "reducer",
    "args": [],
    "kwargs": {},
    "mode": "backward"
  }
]